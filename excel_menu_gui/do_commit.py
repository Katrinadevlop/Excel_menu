#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import subprocess
import sys

def run_git_command(cmd):
    """–í—ã–ø–æ–ª–Ω—è–µ—Ç git –∫–æ–º–∞–Ω–¥—É"""
    try:
        result = subprocess.run(cmd, shell=True, check=True, capture_output=True, text=True, encoding='utf-8')
        print(f"‚úÖ {' '.join(cmd.split()[:2])}: OK")
        return True
    except subprocess.CalledProcessError as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
        if e.stdout:
            print(f"–í—ã–≤–æ–¥: {e.stdout}")
        if e.stderr:
            print(f"–û—à–∏–±–∫–∏: {e.stderr}")
        return False

def main():
    print("üöÄ –î–µ–ª–∞–µ–º –∫–æ–º–º–∏—Ç –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π...")
    print()
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º git
    if not run_git_command("git --version"):
        print("‚ùå Git –Ω–µ –Ω–∞–π–¥–µ–Ω!")
        return False
    
    # –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ —Ñ–∞–π–ª—ã
    print("üì¶ –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ —Ñ–∞–π–ª—ã...")
    if not run_git_command("git add ."):
        return False
    
    # –ö–æ–º–º–∏—Ç —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
    commit_message = """feat: –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ —É–ª—É—á—à–µ–Ω–∏—è

‚ú® –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≤ Excel
- –û—Ç—Å—Ç—É–ø—ã 10px –≤ —è—á–µ–π–∫–∞—Ö –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏ –¥–ª—è –ª—É—á—à–µ–≥–æ –≤–∏–¥–∞
- –í—ã–±–æ—Ä –º–µ—Å—Ç–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π (—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ, –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏, —à–∞–±–ª–æ–Ω—ã, –∂—É—Ä–Ω–∞–ª)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –¥–∞—Ç—ã –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ —Ñ–∞–π–ª–∞ –∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏
- –ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–ª—è —Å–±–æ—Ä–∫–∏ exe –±–µ–∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫

üîß –£–ª—É—á—à–µ–Ω–∏—è:
- –û–±–Ω–æ–≤–ª–µ–Ω —à—Ä–∏—Ñ—Ç –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–π: Gilroy Medium 28pt, –±–µ–ª—ã–π —Ü–≤–µ—Ç
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —à—Ä–∏—Ñ—Ç–∞ –µ—Å–ª–∏ –º–Ω–æ–≥–æ –±–ª—é–¥
- –£–ª—É—á—à–µ–Ω–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞—Ç –∏–∑ —Ñ–∞–π–ª–æ–≤ (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä—É—Å—Å–∫–∏—Ö –º–µ—Å—è—Ü–µ–≤)
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∞—Ç–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –≤ –≤–µ—Ä—Ö–Ω—é—é —á–∞—Å—Ç—å Excel —Ñ–∞–π–ª–∞

üì¶ –°–∏—Å—Ç–µ–º–∞ —Å–±–æ—Ä–∫–∏ exe:
- build_exe.py - –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç —Å–±–æ—Ä–∫–∏
- build.bat / build.ps1 - —Å–∫—Ä–∏–ø—Ç—ã –∑–∞–ø—É—Å–∫–∞ –¥–ª—è Windows
- install_deps.bat - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- build_simple.bat - –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞ PyInstaller
- –ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

üéØ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞ –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö –ø–æ–∏—Å–∫–∞
- –£–ª—É—á—à–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π —Ç–µ–∫—Å—Ç–∞
- –î–æ–±–∞–≤–ª–µ–Ω—ã –æ—Ç—Å—Ç—É–ø—ã –≤ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è—Ö –¥–ª—è –ª—É—á—à–µ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ Excel"""
    
    print("üìù –î–µ–ª–∞–µ–º –∫–æ–º–º–∏—Ç...")
    cmd = ["git", "commit", "-m", commit_message]
    
    try:
        result = subprocess.run(cmd, check=True, capture_output=True, text=True, encoding='utf-8')
        print("‚úÖ –ö–æ–º–º–∏—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ!")
        print("üöÄ –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å: git push")
        return True
    except subprocess.CalledProcessError as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –∫–æ–º–º–∏—Ç–∞: {e}")
        if e.stdout:
            print(f"–í—ã–≤–æ–¥: {e.stdout}")
        if e.stderr:
            print(f"–û—à–∏–±–∫–∏: {e.stderr}")
        return False

if __name__ == "__main__":
    print("=" * 50)
    print("üìù Git –∫–æ–º–º–∏—Ç –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º")
    print("=" * 50)
    
    success = main()
    
    if success:
        print("\n" + "=" * 50)
        print("üéâ –ì–æ—Ç–æ–≤–æ! –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã")
        print("=" * 50)
    else:
        print("\n" + "=" * 50)
        print("‚ùå –ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫")
        print("=" * 50)
