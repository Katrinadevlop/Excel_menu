# Новая функциональность: "Рыба + гарниры на 6 слайд"

## Описание

Добавлена новая функциональность для создания презентации с данными из столбца E Excel файла, включающая блюда от "блюда из рыбы" до "гарниров" и размещающая их на 6-м слайде презентации.

## Как использовать

### В интерфейсе приложения

1. Запустите приложение (`python main.py`)
2. В верхней панели управления найдите кнопку **"Рыба+гарниры на 6 слайд"**
3. Нажмите на неё
4. Выберите Excel файл с меню (должен содержать данные в столбце E)
5. Выберите место сохранения презентации
6. Программа создаст презентацию с данными на 6-м слайде

### Программно

```python
from presentation_handler import create_presentation_with_fish_and_side_dishes

success, message = create_presentation_with_fish_and_side_dishes(
    template_path="путь/к/шаблону.pptx",
    excel_path="путь/к/excel_файлу.xlsx", 
    output_path="путь/к/готовой_презентации.pptx"
)

if success:
    print(f"✅ {message}")
else:
    print(f"❌ {message}")
```

## Требования к Excel файлу

Excel файл должен содержать:

1. **Столбец E** с названиями блюд
2. **Столбец F** (опционально) с весом/граммовкой
3. **Столбец G** (опционально) с ценой
4. **Заголовки категорий:**
   - Строку с текстом "БЛЮДА ИЗ РЫБЫ" или "РЫБНЫЕ БЛЮДА"
   - Строку с текстом "ГАРНИРЫ" или "ГАРНИР"

Программа извлечёт все данные между этими заголовками включительно.

## Структура данных

Каждое блюдо включает:
- **Название** (столбец E) - обязательно
- **Вес/граммовка** (столбец F) - опционально 
- **Цена** (столбец G) - опционально (автоматически добавляет "руб." если указано только число)

## Требования к шаблону презентации

Шаблон презентации должен:
- Содержать минимум 6 слайдов
- 6-й слайд должен содержать таблицу с 3 колонками:
  - Название блюда
  - Вес/граммовка  
  - Цена

## Форматирование в презентации

Данные в таблице автоматически форматируются:
- **Шрифт:** Gilroy Medium
- **Размер:** 28pt (автоматически уменьшается при большом количестве блюд)
- **Цвет:** белый
- **Отступы:** 10 пикселей со всех сторон
- **Выравнивание:** название - по левому краю, вес и цена - по центру

## Тестирование

Для тестирования функциональности запустите:

```bash
python test_fish_garnish.py
```

## Файлы проекта

### Основные файлы:
- `main.py` - главное приложение с новой кнопкой
- `presentation_handler.py` - содержит новые функции:
  - `extract_fish_to_side_dishes_from_column_e()` - извлечение данных из Excel
  - `create_presentation_with_fish_and_side_dishes()` - создание презентации

### Тестовые файлы:
- `test_fish_garnish.py` - скрипт для тестирования функциональности
- `README_fish_garnish.md` - данная документация

## Пример использования

1. **Excel файл содержит:**
   ```
   ...
   БЛЮДА ИЗ РЫБЫ
   Рыба жареная      | 150г  | 180
   Судак в кляре     | 120г  | 220
   ...
   ГАРНИРЫ
   Рис отварной      | 100г  | 45
   Картофель пюре    | 150г  | 50
   ...
   ```

2. **Результат на 6-м слайде:**
   ```
   | Название блюда    | Вес/граммовка | Цена |
   |------------------|---------------|------|
   | Рыба жареная     | 150г          | 180  |
   | Судак в кляре    | 120г          | 220  |
   | Рис отварной     | 100г          | 45   |
   | Картофель пюре   | 150г          | 50   |
   ```

## Возможные ошибки

- **"Заголовок 'БЛЮДА ИЗ РЫБЫ' не найден"** - проверьте наличие соответствующего заголовка в Excel
- **"Презентация должна содержать минимум 6 слайдов"** - используйте шаблон с достаточным количеством слайдов
- **"Шаблон презентации не найден"** - убедитесь, что файл `presentation_template.pptx` находится в папке `templates/`

## Поддержка

При возникновении проблем проверьте:
1. Правильность структуры Excel файла
2. Наличие шаблона презентации
3. Достаточное количество слайдов в шаблоне
4. Наличие таблицы на 6-м слайде шаблона
