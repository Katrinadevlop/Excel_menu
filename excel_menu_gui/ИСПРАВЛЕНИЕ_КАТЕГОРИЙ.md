# Исправление разделения категорий завтраков и салатов

## Проблема
При переносе меню из одного файла в другой блюда из категории "ЗАВТРАКИ" (строка A6) смешивались с блюдами из категории "САЛАТЫ И ХОЛОДНЫЕ ЗАКУСКИ" (строка A30), потому что обе категории находятся в одной колонке A.

## Причина
Функции поиска заголовков категорий (`find_data_start_row`, `find_category_end_row`, `extract_dishes_with_details`) не учитывали расположение заголовков и искали ключевые слова по всему файлу без учёта контекста.

## Решение

### 1. Улучшен метод `find_data_start_row`
Добавлена специальная логика для завтраков и салатов:

```python
# Завтраки ищем только в начале файла (строки 1-15)
if category == 'завтрак':
    for row in range(1, min(15, ws.max_row + 1)):
        if 'завтрак' in cell_text and 'салат' not in cell_text:
            return row + 1

# Салаты ищем только после завтраков (строки 20+)
if category == 'салат':
    for row in range(20, min(50, ws.max_row + 1)):
        if 'салат' in cell_text and ('холодн' in cell_text or 'закуск' in cell_text):
            return row + 1
```

### 2. Улучшен метод `find_category_end_row`
Добавлена специальная логика для салатов:

```python
# Для салатов - останавливаемся перед следующими категориями
if category == 'салат':
    for row in range(start_row, min(200, ws.max_row + 1)):
        if any(header in cell_text for header in ['первые', 'напит', 'хлеб', 'блюда из']):
            return row - 1
```

### 3. Улучшен метод `extract_dishes_with_details`
Переработана логика определения категорий с учётом номера строки:

```python
# Завтраки: только в строках до 15
if 'завтрак' in cell_text and 'салат' not in cell_text and row < 15:
    current_category = 'завтрак'

# Салаты: только в строках после 20
elif ('салат' in cell_text or 'закуск' in cell_text) and row >= 20:
    current_category = 'салат'
```

## Результат
После исправлений:
- ✅ Завтраки корректно определяются в строках 7-27 (после заголовка в A6)
- ✅ Салаты корректно определяются в строках 29-59 (после заголовка в A28)
- ✅ Диапазоны не пересекаются
- ✅ Блюда не смешиваются между категориями

## Тестирование
Для проверки корректности работы запустите:
```bash
python test_categories_separation.py
```

Тест проверяет:
1. Правильность определения начала и конца категорий
2. Отсутствие пересечений диапазонов
3. Корректное расположение заголовков

## Структура шаблона
```
A6:  ЗАВТРАКИ
A7-A27: блюда завтраков
A28: (пустая строка)
A30: САЛАТЫ и ХОЛОДНЫЕ ЗАКУСКИ  
A31-A42: блюда салатов
```

## Файлы, которые были изменены
- `app/services/menu_template_filler.py` - основная логика переноса меню
- `test_categories_separation.py` - тестовый скрипт для проверки
