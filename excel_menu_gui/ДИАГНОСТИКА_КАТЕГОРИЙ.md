# Диагностика проблемы "Не найдена ни одна категория"

## Описание проблемы
При создании презентации появляется сообщение: **"Не удалось создать презентацию в эксель файле не найдена ни одна категория"**

## Быстрая диагностика

### Шаг 1: Запуск тестового скрипта
1. Откройте командную строку в папке проекта
2. Запустите: `python test_categories.py "путь_к_вашему_excel_файлу.xlsx"`
3. Или просто запустите: `run_test.bat` и введите путь к файлу

### Шаг 2: Подробная диагностика (если тест не помог)
1. Запустите: `python debug_categories.py "путь_к_вашему_excel_файлу.xlsx"`
2. Изучите вывод - он покажет все содержимое первых строк файла

## Частые причины проблемы

### 1. Неправильные названия категорий
**Ожидаемые названия категорий в Excel:**
- САЛАТЫ И ХОЛОДНЫЕ ЗАКУСКИ (или просто САЛАТЫ, ЗАКУСКИ)
- ПЕРВЫЕ БЛЮДА (или СУПЫ, БОРЩ)
- БЛЮДА ИЗ МЯСА / МЯСНЫЕ БЛЮДА (или МЯСО, ГОВЯДИНА)
- БЛЮДА ИЗ ПТИЦЫ (или ПТИЦА, КУРИЦА)
- БЛЮДА ИЗ РЫБЫ / РЫБНЫЕ БЛЮДА (или РЫБА)
- ГАРНИРЫ (или ГАРНИР, КАША, КАРТОФЕЛЬ)

### 2. Неправильный лист Excel
- Программа ищет лист с названием содержащим "касс"
- Если такого нет, использует первый лист
- Убедитесь, что категории находятся в правильном листе

### 3. Неправильное расположение категорий
- Категории должны быть написаны ЗАГЛАВНЫМИ БУКВАМИ
- Категории должны находиться в первых 30 строках файла
- После названия категории должны идти блюда

## Решения

### Вариант 1: Исправить Excel файл
1. Откройте ваш Excel файл
2. Найдите названия категорий
3. Убедитесь, что они написаны заглавными буквами
4. Переместите их в начало листа (первые 30 строк)

### Вариант 2: Модифицировать код (для продвинутых пользователей)
Если ваши категории называются по-другому, можно изменить ключевые слова в файле `presentation_handler.py`:

```python
def extract_salads_from_excel(excel_path: str) -> List[MenuItem]:
    keywords = [
        'ВАШ_ВАРИАНТ_НАЗВАНИЯ_САЛАТОВ',  # добавьте сюда
        'САЛАТЫ И ХОЛОДНЫЕ ЗАКУСКИ',
        # ... остальные варианты
    ]
```

## Примеры правильной структуры Excel

```
Строка 1: Название организации
Строка 2: Дата меню
Строка 3: 
Строка 4: САЛАТЫ И ХОЛОДНЫЕ ЗАКУСКИ
Строка 5: Салат "Оливье" | 100г | 85 руб.
Строка 6: Салат из капусты | 150г | 45 руб.
Строка 7:
Строка 8: ПЕРВЫЕ БЛЮДА  
Строка 9: Борщ украинский | 250г | 120 руб.
...
```

## Файлы для диагностики

1. **`test_categories.py`** - быстрый тест всех категорий
2. **`debug_categories.py`** - подробный анализ содержимого файла
3. **`run_test.bat`** - удобный запуск теста

## Получение помощи

Если проблема не решается:
1. Запустите `debug_categories.py`
2. Сохраните вывод в текстовый файл
3. Приложите первые 20 строк вашего Excel файла
4. Обратитесь к разработчику с этой информацией

## Обновленные функции

В новой версии добавлены:
- ✅ Подробное логирование поиска категорий
- ✅ Более гибкий поиск (частичное совпадение)
- ✅ Расширенный список ключевых слов
- ✅ Инструменты диагностики

Теперь программа должна находить категории даже при небольших отличиях в названиях.
